<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/estilos.css">
    <title>Desarme de Estibas - FixEstibas</title>
</head>
<body>
<header>
    <div class="logo">
        <img src="/logo.png" style="width: 100px; padding: 0"><h1> FixEstibas</h1>
    </div>

    <nav>
        <ul>
            <li><a href="/index">Inicio</a></li>
            <li><a href="/estibas">Desarme de Estibas</a></li>
            <li><a href="/usuarios">Nuevo Usuario</a></li>
            <li><a href="">Cerrar sesión</a></li>
        </ul>
    </nav>
</header>

<div class="main-content">
    <h2>Seleccione el Tipo de Estiba para Desarme</h2>
    <label>Fecha:</label>
    <input type="date" id="fecha" required><br>
    <div class="estibas-seleccion">
        <div class="estiba" onclick="seleccionarEstiba('Grande')">
            <img src="/estiba.jpg" style="width: 200px;">
            <p>GRANDE 1.30m x 1.30m</p>
        </div>
        <div class="estiba" onclick="seleccionarEstiba('Mediana')">
            <img src="/estiba.jpg" style="width: 200px;">
            <p>MEDIANA 1.05m x 1.05m</p>
        </div>
        <div class="estiba" onclick="seleccionarEstiba('Pequeña')">
            <img src="/estiba.jpg" style="width: 200px;">
            <p>PEQUEÑA 90cm x 90cm</p>
        </div>
    </div>

    <form id="estibaForm" onsubmit="guardarEstiba(); return false;">
        <label id="tipoEstibaSeleccionada">Tipo de Estiba Seleccionada:</label><br>



        <label>Cantidad de Tablas:</label>
        <input type="number" id="cantidadTablas" required><br>

        <label>Cantidad de Tacos:</label>
        <input type="number" id="cantidadTacos" required><br>

        <button type="submit">Guardar</button>
    </form>
</div>
<script src="/app.js">

    function obtenerTotalesDelDia() {
        // URLs para cada tipo de estiba
        const urls = {
            pequena: "http://localhost:8080/api/estibas/totales/pequeña",
            mediana: "http://localhost:8080/api/estibas/totales/mediana",
            grande: "http://localhost:8080/api/estibas/totales/grande"
        };

        // Variables para acumular el total de tacos
        let totalTacos = 0;

        // Función para procesar la respuesta de cada tipo de estiba
        function procesarRespuesta(tipo, data) {
            document.getElementById(`totales${tipo}Tablas`).innerText = `${data[0]} Tablas`;
            totalTacos += data[1]; // Acumular tacos
            document.getElementById("totalesTacos").innerText = `${totalTacos} Tacos`; // Actualizar tacos totales
        }

        // Solicitar y procesar datos para cada tipo de estiba
        Object.keys(urls).forEach(tipo => {
            fetch(urls[tipo])
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`Error en la solicitud: ${response.status}`);
                    }
                    return response.json(); // Convertir respuesta a JSON
                })
                .then(data => procesarRespuesta(tipo.charAt(0).toUpperCase() + tipo.slice(1), data)) // Actualizar dashboard
                .catch(error => {
                    console.error(`Error al obtener los datos de ${tipo}:`, error);
                    document.getElementById(`totales${tipo}Tablas`).innerText = "Error al cargar";
                });
        });
    }

    // Llamar a la función al cargar la página
    docume
</script>


</body>
</html>
